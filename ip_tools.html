<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IP Address Tools</title>
<style>
/* General body styling */
body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background-color: #cee0f5;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.container {
    background: #ffffff;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    width: 90%;
    max-width: 600px;
    text-align: center;
    overflow-y: auto;
    max-height: 90vh;
}

.container h1 {
    margin-bottom: 20px;
    color: #333;
}

textarea, input {
    width: 100%;
    padding: 10px;
    border-radius: 10px;
    border: 1px solid #ccc;
    resize: none;
    font-size: 16px;
    margin-bottom: 10px;
}

button.home-btn {
    background-color: #849ebd;
    color: white;
    border: none;
    border-radius: 25px;
    padding: 10px 20px;
    margin: 10px 5px;
    cursor: pointer;
    font-size: 16px;
    transition: background 0.3s, transform 0.2s;
}

button.home-btn:hover {
    background-color: #6a84a0;
    transform: scale(1.05);
}

.output-box {
    margin-top: 15px;
    white-space: pre-wrap;
    word-break: break-all;
    border: 1px solid #ddd;
    padding: 10px;
    border-radius: 10px;
    background: #f8f8f8;
}
</style>
</head>
<body>

<div class="container">
    <h1>IP Address Tools</h1>

    <h3>Subnet Mask ↔ CIDR Converter</h3>
    <textarea id="maskInput" rows="2" placeholder="/30 or 255.255.255.252"></textarea>
    <button class="home-btn" onclick="convertMask()">Convert</button>
    <div id="maskOutput" class="output-box">Output will appear here...</div>

    <hr>

    <h3>Subnet Calculator</h3>
    <input type="text" id="ipAddress" placeholder="IP Address e.g., 192.168.1.10">
    <input type="text" id="subnetMask" placeholder="Subnet Mask e.g., /24 or 255.255.255.0">
    <button class="home-btn" onclick="calculateSubnet()">Calculate</button>
    <div id="subnetOutput" class="output-box">Subnet calculation will appear here...</div>

    <button class="home-btn" onclick="location.href='index.html'">Back Home</button>
</div>

<script>
// ===== Helper Functions =====
function ipToNumber(ip) {
    return ip.split('.').reduce((acc, octet) => (acc << 8) + parseInt(octet), 0) >>> 0;
}

function numberToIp(num) {
    return [
        (num >>> 24) & 255,
        (num >>> 16) & 255,
        (num >>> 8) & 255,
        num & 255
    ].join('.');
}

// Subnet Mask ↔ CIDR
function cidrToMask(cidr) {
    return numberToIp(~((1 << (32 - cidr)) - 1) >>> 0);
}

function maskToCidr(mask) {
    const maskNum = ipToNumber(mask);
    let cidr = 0;
    for (let i = 31; i >= 0; i--) {
        if ((maskNum >>> i) & 1) cidr++;
        else break;
    }
    return "/" + cidr;
}

// Convert Subnet Mask ↔ CIDR
function convertMask() {
    let input = document.getElementById("maskInput").value.trim();
    let output = "";

    if (input.startsWith("/")) {
        let cidr = parseInt(input.replace("/", ""));
        if (cidr < 0 || cidr > 32 || isNaN(cidr)) {
            output = "Invalid CIDR notation.";
        } else {
            output = cidrToMask(cidr);
        }
    } else if (input.includes(".")) {
        let parts = input.split(".");
        if (parts.length !== 4 || parts.some(p => isNaN(p) || p < 0 || p > 255)) {
            output = "Invalid subnet mask.";
        } else {
            output = maskToCidr(input);
        }
    } else {
        output = "Invalid input format.";
    }

    document.getElementById("maskOutput").textContent = output;
}

// ===== Subnet Calculator =====
function calculateSubnet() {
    let ip = document.getElementById("ipAddress").value.trim();
    let maskInput = document.getElementById("subnetMask").value.trim();
    let output = document.getElementById("subnetOutput");

    // Validate IP
    let ipOctets = ip.split('.').map(Number);
    if (ipOctets.length !== 4 || ipOctets.some(o => isNaN(o) || o<0 || o>255)) {
        output.textContent = "Invalid IP address.";
        return;
    }

    // Get CIDR
    let maskCidr;
    if (maskInput.startsWith("/")) {
        maskCidr = parseInt(maskInput.replace("/", ""));
    } else {
        maskCidr = parseInt(maskToCidr(maskInput).replace("/", ""));
    }

    if (maskCidr < 0 || maskCidr > 32) {
        output.textContent = "Invalid subnet mask.";
        return;
    }

    let ipNum = ipToNumber(ip);
    let maskNum = (~0 << (32 - maskCidr)) >>> 0;
    let networkNum = ipNum & maskNum;
    let broadcastNum = networkNum | (~maskNum >>> 0);

    let firstUsable = maskCidr < 31 ? networkNum + 1 : networkNum;
    let lastUsable = maskCidr < 31 ? broadcastNum - 1 : broadcastNum;

    let totalHosts = Math.pow(2, 32 - maskCidr);
    let usableHosts = maskCidr < 31 ? totalHosts - 2 : totalHosts;

    output.textContent = 
`Network Address: ${numberToIp(networkNum)}
Broadcast Address: ${numberToIp(broadcastNum)}
Usable Range: ${numberToIp(firstUsable)} – ${numberToIp(lastUsable)}
CIDR: /${maskCidr}
Total Hosts: ${totalHosts}
Usable Hosts: ${usableHosts}`;
}
</script>

</body>
</html>
